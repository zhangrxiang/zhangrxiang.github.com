# 线程

## 历史
> 线程的动机是充分利用多核，方便地实现并行编程。然而，早期的硬件厂商纷纷实现自己的一套线程标准，这样，程序员无法开发可移植的软件。为了结束这个局面，对UNIX系统，IEEE制定了一个C语言线程编程接口标准（IEEE POSIX 1003.1c）。参考这个标准的实现就被称作POSIX threads 或者 Pthreads.

在理解线程之前，可以考察一个UNIX进程。一个进程由操作系统创建，包含一些程序资源和运行状态的信息，包括：
- 进程ID, 进程组ID, 用户ID和组ID
- 运行时环境
- 运行时目录
- 程序指令序列
- 寄存器
- 栈
- 堆
- 文件句柄
- 信号量动作
- 共享库
- 程序间通信的一些技术和工具（例如消息队列，管道和共享内存）

线程是一些独立的指令流，并且可以被操作系统调度。指令流执行的控制之所以是独立的，并且能被调度，源于线程有独立的：
1. 栈指针
- 寄存器
- 调度属性（例如：策略和优先级）
- 挂起和阻塞的信号量集合
-线程相关的数据
总而言之，在UNIX中，一个线程：
- 存在于进程中，可以使用进程的资源
- 只要宿主进程存在，并且有操作系统的支持，一个线程就可以有独立的控制流程
- 和其他独立（或有依赖）的线程共享进程的资源
- 如果宿主进程退出，线程也会退出
线程是轻量级的是因为负载已经由宿主进程承担
因为多个线程存在于一个进程中，这会导致下面几种情况：

某个线程改变了进程中的某个资源（例如打开一个文件，或关闭一个文件）会被其他线程观察到
多线程可以拥有对同一个数据的指针
多个线程可以访问共享内存，所以，需要开发人员做显式的同步操作

## 概述 （thread）
> 在一个程序里的多个执行路线就叫做线程。更准确的定义是：线程是“一个进程内部的一个控制序列”。
线程是允许应用程序并发执行多个任务的一种机制
一个进程可以包含多个线程，同一程序中的所有线程均会独立执行相同的程序，且共享同一份全局内存区域，包括初始化数据段（initialized data），未初始化数据段（uninitialized data），
以及堆内存段（heap segment）


## 线程的优点
- 当与创建和管理进程的花费相比，线程可以使用操作系统较少的开销，管理线程需要较少的系统资源。 
- 在同一个进程中的所有线程共享同样的地址空间。较于进程间的通信，在许多情况下线程间的通信效率比较高，且易于使用。 
- 异步事件处理：频率和持续时间不确定的任务可以交错。例如，web服务器可以同时为前一个请求传输数据和管理新请求。 通过为每种事件类型的处理分配单独的线程，能够简化处理异步时间的代码。
- 交互的程序可以通过使用多线程实现相应时间的改善，多线程可以把程序中处理用户输入输出的部分与其它部分分开。